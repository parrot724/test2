(function(e){function t(t){for(var a,i,o=t[0],l=t[1],c=t[2],d=0,p=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==r[l]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={app:0},s=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"075a":function(e,t,n){"use strict";var a=n("9eff"),r=n.n(a);r.a},"0831":function(e,t,n){"use strict";var a=n("2277"),r=n.n(a);r.a},2277:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("d9a3"),n("c9db"),n("de3e"),n("618d");var a=n("0261"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("nav",{staticClass:"navbar navbar-expand-sm navbar-dark bg-primary"},[n("span",{staticClass:"navbar-brand"},[e._v("Human AI @ JLU")]),n("span",{staticClass:"navbar-text pr-5"},[e._v("智慧课堂")]),n("ul",{staticClass:"navbar-nav"},[e.login?n("li",{staticClass:"nav-item px-2"},[n("a",{staticClass:"nav-link",attrs:{href:"#"}},[e._v("你好, "+e._s(e.username)+"["+e._s(e.userId)+"]")])]):e._e(),e.login?e._e():n("li",{staticClass:"nav-item px-2",class:{active:1===e.nav},attrs:{id:"nav_upload"},on:{click:function(t){return e.switchNav(1)}}},[n("a",{staticClass:"nav-link",attrs:{href:"#"}},[e._v("登录")])]),n("li",{staticClass:"nav-item px-2",class:{active:2===e.nav},attrs:{id:"nav_edit"},on:{click:function(t){return e.switchNav(2)}}},[n("a",{staticClass:"nav-link",attrs:{href:"#"}},[e._v("课程播放")])])])]),n("div",{staticClass:"container-fluid"},[1===e.nav?n("student-login",{on:{login:function(t){return e.loginSuccess(t)}}}):e._e(),2===e.nav?n("display-class",{attrs:{"student-id":e.userId}}):e._e()],1)])},s=[],i=(n("d52a"),n("9d79"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container-fluid"},[n("br"),n("div",{staticClass:"container"},[n("form",{staticClass:"form"},[n("div",{staticClass:"form-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.currentSelectedClass,expression:"currentSelectedClass"}],staticClass:"form-control",attrs:{name:"currentClass",id:"current_class_selector"},on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.currentSelectedClass=t.target.multiple?n:n[0]},e.switchClass]}},[n("option",{attrs:{value:"0000"}},[e._v("点击选择你要观看的课程")]),e._l(e.classList,(function(t){return n("option",{key:t,domProps:{value:t}},[e._v(e._s(t)+" ")])}))],2)])])]),n("hr"),null!==e.pages?n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row",staticStyle:{border:"1px solid gainsboro",position:"relative",height:"540px","box-sizing":"border-box",overflow:"hidden"}},[n("div",{staticClass:"col-xl-3",staticStyle:{height:"100%"}},[n("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"flex-start","overflow-y":"scroll","border-right":"1px solid gainsboro","overflow-x":"hidden",height:"100%"}},e._l(e.pages,(function(t,a){return n("div",{key:a,staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[n("h6",{class:{"text-danger":a===e.currentPageIndex},staticStyle:{"text-align":"center"}},[e._v(" "+e._s(a+1)+" ")]),n("img",{class:{"border-red-3px":a===e.currentPageIndex},staticStyle:{margin:"5px",border:"1px solid gainsboro"},attrs:{src:"http://localhost:5500/"+e.currentSelectedClass+"/"+a+".jpg",width:"300",height:"200"},on:{click:function(t){return e.switchPage(a)}}})])})),0)]),n("div",{staticClass:"col-xl-9"},[n("div",{staticStyle:{position:"relative",opacity:"1","background-color":"white"}},[n("img",{staticStyle:{position:"absolute",top:"0",left:"200px","background-color":"white",opacity:"1"},attrs:{width:"960",height:"540",alt:"PPT edit background",src:"http://localhost:5500/"+e.currentSelectedClass+"/"+e.currentPageIndex+".jpg"}}),n("canvas",{staticClass:"ppt-page-canvas",staticStyle:{position:"absolute",left:"200px"},attrs:{id:"canvas_note_indicator",width:"960",height:"540"}}),n("div",{staticStyle:{padding:"0",margin:"0",position:"absolute",top:"0",left:"200px",width:"960px",height:"540px",overflow:"hidden"}},e._l(e.pages[e.currentPageIndex].pageNotes,(function(t,a){return n("span",{key:e.currentSelectedClass+"-"+e.currentPageIndex+"-"+a,staticStyle:{position:"absolute","font-size":"20px",cursor:"pointer",padding:"2px 50px 2px 5px","border-radius":"22px","background-color":"#2a93ca",opacity:"1",color:"white"},style:{left:t.x+t.width-78+"px",top:t.y+t.height-35+"px"},attrs:{id:"ppt_note_item_"+a,"data-index":a,"data-x":t.x,"data-y":t.y,"data-width":t.width,"data-height":t.height},on:{click:function(t){return e.playNoteAudio(e.currentPageIndex+1+"-"+(a+1))}}},[n("i",{staticClass:"fas fa-volume-up"})])})),0)])])])]):e._e()])}),o=[],l=(n("4178"),n("fc88"),n("e350"),n("7ae7"),n("af82"),n("3a20"),n("b3f9"),n("ef8e"),n("3e5e"),n("94ec"),n("9a14"),n("252a"),n("b449"),n("e980"));n("84f7"),n("5897"),n("f9b0"),n("0b1e"),n("cf52");function c(e){return u.apply(this,arguments)}function u(){return u=Object(l["a"])(regeneratorRuntime.mark((function e(t){var n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.abrupt("return",new Promise((function(e,a){var r=new XMLHttpRequest;r.open("GET",t),Object.keys(n).forEach((function(e){r.setRequestHeader(e,n[e])})),r.onload=function(){e(r.responseText)},r.onerror=function(e){a(e)},r.send()})));case 2:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function d(){var e=document.getElementById("global_cover");if(e)e.style.display="block";else{var t=document.createElement("div");t.style.backgroundColor="black",t.style.opacity="0.6",t.style.width="100%",t.style.height="100%",t.style.position="fixed",t.style.left=0,t.style.top=0,t.id="global_cover",t.style.zIndex=500,document.body.appendChild(t)}}function p(){var e=document.getElementById("global_cover");e&&(e.style.display="none")}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"加载中...",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?d():p();var n=document.getElementById("loading_wrapper");if(n)return n.style.display="flex",void(document.getElementById("loading_text").innerText=e);var a=document.createElement("div");a.style.width="100%",a.style.height="100%",a.style.position="fixed",a.style.left=0,a.style.top=0,a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center",a.id="loading_wrapper",a.style.zIndex=501;var r=document.createElement("div");r.className="spinner-border text-light",a.appendChild(r);var s=document.createElement("h3");s.innerText=e,s.id="loading_text",s.style.color="white",s.style.padding="40px",s.style.margin=0,a.appendChild(s),document.body.appendChild(a)}function f(){p();var e=document.getElementById("loading_wrapper");e&&(e.style.display="none",document.getElementById("loading_text").innerText="加载中...")}var g=n("5d40"),h={name:"DisplayClass",props:{studentId:{required:!0}},data:function(){return{username:null,emotions:{},classList:[],pages:null,currentSelectedClass:"0000",currentPageIndex:0}},methods:{playNoteAudio:function(e){e="voice_results/"+e+".wav",console.log(e);var t=new g["Howl"]({src:[e],format:["mp4","m4a","wav"]});t.play()},switchClass:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("0000"!==e.currentSelectedClass){t.next=4;break}return e.pages=null,e.currentPageIndex=0,t.abrupt("return");case 4:if(e.pages=null,e.currentPageIndex=0,v(),t.prev=7,"localhost:5500"!==location.host){t.next=14;break}return t.next=11,c("http://localhost:5500/".concat(e.currentSelectedClass,"/emotion_results/").concat(e.username,".txt"));case 11:n=t.sent,t.next=17;break;case 14:return t.next=16,c("emotion_results/".concat(e.username,".txt"));case 16:n=t.sent;case 17:return console.log(n),a={},n.trim().split("\n").forEach((function(e){""!==e&&(console.log(e),a[e.split(":")[0]]=e.split(":")[1])})),console.log(a),e.emotions=a,t.t0=JSON,t.next=25,c("http://localhost:5000/get_class_data?className="+e.currentSelectedClass);case 25:t.t1=t.sent,r=t.t0.parse.call(t.t0,t.t1),r.ok?e.pages=r.data.pages:alert(r.message),t.next=34;break;case 30:t.prev=30,t.t2=t["catch"](7),console.log(t.t2),alert("课程数据加载失败, 请检查网络连接");case 34:f(),e.drawNoteIndicator(e.currentPageIndex);case 36:case"end":return t.stop()}}),t,null,[[7,30]])})))()},switchPage:function(e){this.currentPageIndex=e,this.drawNoteIndicator(e)},drawNoteIndicator:function(e){var t=this,n=this;setTimeout((function(){var a=n.pages[e].pageNotes,r=document.getElementById("canvas_note_indicator"),s=r.getContext("2d");s.clearRect(0,0,960,640),s.lineWidth=1,s.strokeStyle="#2a93ca";var i=1,o=!0,l=!1,c=void 0;try{for(var u,d=a[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var p=u.value,v="".concat(t.currentPageIndex+1,"-").concat(i);"negative"===t.emotions[v]&&(s.strokeStyle="#ca2a3f"),s.strokeRect(p.x,p.y,p.width,p.height),i++,s.strokeStyle="#2a93ca"}}catch(f){l=!0,c=f}finally{try{o||null==d.return||d.return()}finally{if(l)throw c}}}),300)}},mounted:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(v(),t.prev=1,n=parseInt(e.studentId),!isNaN(n)){t.next=8;break}return alert("学生学号必须为整数"),t.abrupt("return");case 8:e.username="student"+n;case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t["catch"](1),alert("学生学号必须为整数"),t.abrupt("return");case 15:return t.prev=15,t.t1=JSON,t.next=19,c("http://localhost:5000/get_class_list");case 19:t.t2=t.sent,a=t.t1.parse.call(t.t1,t.t2),a.ok?e.classList=a.data:alert(a.message),t.next=28;break;case 24:t.prev=24,t.t3=t["catch"](15),console.log(t.t3),alert("加载课程列表失败, 请检查网络连接状况");case 28:f();case 29:case"end":return t.stop()}}),t,null,[[1,11],[15,24]])})))()}},m=h,y=(n("0831"),n("623f")),x=Object(y["a"])(m,i,o,!1,null,"28f4cd3d",null),b=x.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"root container"},[e._m(0),n("hr"),n("br"),n("br"),n("div",[n("form",{staticClass:"form"},[n("div",{staticClass:"form-group"},[n("label",[e._v("学生姓名:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{required:"",placeholder:"请输入"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),n("br"),n("br"),n("div",{staticClass:"form-group"},[n("label",[e._v("学号:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userId,expression:"userId"}],attrs:{required:"",placeholder:"请输入"},domProps:{value:e.userId},on:{input:function(t){t.target.composing||(e.userId=t.target.value)}}})])]),n("br"),n("br"),n("button",{on:{click:e.login}},[e._v("登录")])])])},w=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"title"},[n("h3",[e._v("学生登录")])])}],C={name:"StudentLogin",data:function(){return{username:"",userId:""}},methods:{login:function(){this.$emit("login",[this.username,this.userId])}}},k=C,I=(n("93db"),Object(y["a"])(k,_,w,!1,null,"0631dae1",null)),S=I.exports,P={name:"app",components:{StudentLogin:S,DisplayClass:b},data:function(){return{nav:1,login:!1,username:null,userId:null}},methods:{switchNav:function(e){(1!==this.nav||this.login)&&(this.nav=e)},loginSuccess:function(e){this.login=!0,this.username=e[0],this.userId=e[1],this.switchNav(2)}}},j=P,N=(n("075a"),Object(y["a"])(j,r,s,!1,null,"410f6172",null)),O=N.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(O)}}).$mount("#app")},"8e1c":function(e,t,n){},"93db":function(e,t,n){"use strict";var a=n("8e1c"),r=n.n(a);r.a},"9eff":function(e,t,n){}});
//# sourceMappingURL=app.ab1a9196.js.map