(function(t){function e(e){for(var a,r,o=e[0],c=e[1],l=e[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},3985:function(t,e,n){},"4fcb":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("d9a3"),n("c9db"),n("de3e"),n("618d");var a=n("0261"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("nav",{staticClass:"navbar navbar-expand-sm navbar-dark bg-primary"},[n("span",{staticClass:"navbar-brand"},[t._v("Human AI @ JLU")]),n("span",{staticClass:"navbar-text pr-5"},[t._v("智慧课堂")]),n("ul",{staticClass:"navbar-nav"},[t.login?n("li",{staticClass:"nav-item px-2"},[n("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("你好,"+t._s(t.username))])]):t._e(),t.login?t._e():n("li",{staticClass:"nav-item px-2",class:{active:1===t.nav},attrs:{id:"nav_upload"},on:{click:function(e){return t.switchNav(1)}}},[n("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("教师登录")])]),n("li",{staticClass:"nav-item px-2",class:{active:2===t.nav},attrs:{id:"nav_edit"},on:{click:function(e){return t.switchNav(2)}}},[n("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("上传课程")])]),n("li",{staticClass:"nav-item px-2",class:{active:3===t.nav},attrs:{id:"nav_display"},on:{click:function(e){return t.switchNav(3)}}},[n("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("编辑课程")])])])]),n("div",{staticClass:"container-fluid"},[1===t.nav?n("teacher-login",{on:{login:function(e){return t.loginSuccess(e)}}}):t._e(),2===t.nav?n("upload-file"):t._e(),3===t.nav?n("edit-file"):t._e()],1)])},i=[],r=(n("d52a"),n("9d79"),n("3985"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[t._m(0),n("hr"),n("br"),n("br"),n("div",{staticClass:"form-wrapper"},[n("form",{staticClass:"form",attrs:{id:"upload_file_form"},on:{submit:function(e){return e.preventDefault(),t.upload(e)}}},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"upload_class_name"}},[t._v("课程名称:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.className,expression:"className"}],attrs:{id:"upload_class_name",required:""},domProps:{value:t.className},on:{input:function(e){e.target.composing||(t.className=e.target.value)}}})]),n("br"),n("br"),n("div",{staticClass:"label"},[t._v("选择要上传的pdf文件")]),t._m(1),n("br"),n("br"),n("button",{attrs:{type:"submit"}},[t._v("上传")])])])])}),o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[n("h3",[t._v("上传PPT文件")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group"},[n("div",{staticClass:"custom-file"},[n("input",{staticClass:"custom-file-input",attrs:{id:"upload_file_input",type:"file",accept:"application/pdf",required:""}}),n("label",{staticClass:"custom-file-label",attrs:{for:"upload_file_input","data-browse":"选择文件"}},[t._v("点击选择要上传的pdf文件")])])])}],c=(n("b449"),n("e980"));n("84f7"),n("5897"),n("f9b0"),n("0b1e"),n("cf52");function l(t){return u.apply(this,arguments)}function u(){return u=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},t.abrupt("return",new Promise((function(t,a){var s=new XMLHttpRequest;s.open("GET",e),Object.keys(n).forEach((function(t){s.setRequestHeader(t,n[t])})),s.onload=function(){t(s.responseText)},s.onerror=function(t){a(t)},s.send()})));case 2:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}function d(t,e){return p.apply(this,arguments)}function p(){return p=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var a,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:{},t.abrupt("return",new Promise((function(t,s){var i=new XMLHttpRequest;i.open("POST",e),Object.keys(a).forEach((function(t){i.setRequestHeader(t,a[t])})),i.onload=function(){t(i.responseText)},i.onerror=function(t){s(t)},i.send(n)})));case 2:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function h(t){return new Promise((function(e,n){var a=new FileReader;a.readAsDataURL(t),a.addEventListener("load",(function(){e(a.result)})),a.addEventListener("error",(function(t){n(t)}))}))}function v(t,e,n,a){return{x:Math.min(t,n),y:Math.min(e,a),width:Math.abs(t-n),height:Math.abs(e-a)}}function f(){var t=document.getElementById("global_cover");if(t)t.style.display="block";else{var e=document.createElement("div");e.style.backgroundColor="black",e.style.opacity="0.6",e.style.width="100%",e.style.height="100%",e.style.position="fixed",e.style.left=0,e.style.top=0,e.id="global_cover",e.style.zIndex=500,document.body.appendChild(e)}}function g(){var t=document.getElementById("global_cover");t&&(t.style.display="none")}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"加载中...",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?f():g();var n=document.getElementById("loading_wrapper");if(n)return n.style.display="flex",void(document.getElementById("loading_text").innerText=t);var a=document.createElement("div");a.style.width="100%",a.style.height="100%",a.style.position="fixed",a.style.left=0,a.style.top=0,a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center",a.id="loading_wrapper",a.style.zIndex=501;var s=document.createElement("div");s.className="spinner-border text-light",a.appendChild(s);var i=document.createElement("h3");i.innerText=t,i.id="loading_text",i.style.color="white",i.style.padding="40px",i.style.margin=0,a.appendChild(i),document.body.appendChild(a)}function b(){g();var t=document.getElementById("loading_wrapper");t&&(t.style.display="none",document.getElementById("loading_text").innerText="加载中...")}var x=n("debc"),y=n.n(x),_=n("4b72"),w=n.n(_),C={name:"UploadFile",data:function(){return{className:"MyClass"}},methods:{upload:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=document.getElementById("upload_file_input"),a=n.files,a.length>1&&alert("一次最多选择一个文件"),0===a.length&&alert("请选择文件"),e.next=6,h(a[0]);case 6:return s=e.sent,e.prev=7,m(),e.next=11,d("http://localhost:5000/upload_class",JSON.stringify({className:t.className,base64Data:s}));case 11:alert("上传成功"),b(),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](7),console.log(e.t0),alert("上传失败");case 19:case"end":return e.stop()}}),e,null,[[7,15]])})))()}},mounted:function(){y()(document).ready((function(){w.a.init()}))}},N=C,P=(n("66c0"),n("623f")),I=Object(P["a"])(N,r,o,!1,null,"6ed1cb61",null),k=I.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid"},[n("br"),n("div",{staticClass:"container"},[n("form",{staticClass:"form"},[n("div",{staticClass:"form-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.currentSelectedClass,expression:"currentSelectedClass"}],staticClass:"form-control",attrs:{name:"currentClass",id:"current_class_selector"},on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentSelectedClass=e.target.multiple?n:n[0]},t.switchClass]}},[n("option",{attrs:{value:"0000"}},[t._v("点击选择你要编辑的课程")]),t._l(t.classList,(function(e){return n("option",{domProps:{value:e}},[t._v(t._s(e))])}))],2)])])]),n("hr"),null!==t.pages?n("div",{staticClass:"ppt-preview",staticStyle:{display:"flex","justify-content":"flex-start","overflow-x":"scroll"}},t._l(t.pages,(function(e,a){return n("div",{key:a,staticClass:"ppt-preview-item"},[n("h6",{class:{"text-danger":a===t.currentPageIndex},staticStyle:{"text-align":"center"}},[t._v(t._s(a+1))]),n("img",{class:{"border-red-3px":a===t.currentPageIndex},staticStyle:{margin:"5px",border:"1px solid gainsboro"},attrs:{src:"http://localhost:5500/"+t.currentSelectedClass+"/"+a+".jpg",width:"160",height:"90"},on:{click:function(e){return t.switchPage(a)}}})])})),0):t._e(),null!==t.pages?n("hr"):t._e(),null!==t.pages?n("div",{staticClass:"tools container",staticStyle:{"text-align":"right"}},[n("button",{staticClass:"btn btn-danger",staticStyle:{margin:"20px"},attrs:{disabled:null==t.currentActiveNote&&null==t.lastActiveNote},on:{click:function(e){return t.deleteNote(t.lastActiveNote.dataset.index)}}},[t._v(" 删除该条笔记 ")])]):t._e(),null!==t.pages?n("div",{staticClass:"ppt-edit",staticStyle:{display:"flex",position:"relative","justify-content":"center"}},[n("div",{staticClass:"ppt-page",staticStyle:{position:"relative",height:"540px",width:"1400px"}},[n("img",{staticStyle:{position:"absolute",top:"0"},attrs:{id:"ppt_edit_background",width:"960",height:"540",alt:"PPT edit backgournd",src:"http://localhost:5500/"+t.currentSelectedClass+"/"+t.currentPageIndex+".jpg"}}),n("canvas",{staticClass:"ppt-page-canvas",staticStyle:{position:"absolute",left:"0",top:"0",border:"1px solid gainsboro"},attrs:{id:"canvas_note_indicator",width:"1400",height:"540"}}),n("div",{staticClass:"ppt-notes",staticStyle:{padding:"0",margin:"0",position:"absolute",top:"0",right:"0",width:"300px",height:"540px","overflow-y":"scroll"},on:{scroll:t.notesScroll}},t._l(t.pages[t.currentPageIndex].pageNotes,(function(e,a){return n("div",{key:t.currentSelectedClass+"-"+t.currentPageIndex+"-"+a,staticClass:"note-content hide-scroll-bar",staticStyle:{height:"80px",border:"1px solid gray",padding:"5px",margin:"10px 0","overflow-y":"scroll",outline:"none"},attrs:{id:"ppt_note_item_"+a,contenteditable:"true","data-index":a,"data-x":e.x,"data-y":e.y,"data-width":e.width,"data-height":e.height},on:{focus:function(e){return t.noteFocus(e)},blur:function(e){return t.noteBlur(e)}}},[t._v(" "+t._s(e.noteContent)+" ")])})),0),n("my-canvas-rect",{attrs:{width:"960",height:"540"},on:{rect:function(e){return t.addNewNote(e)}}})],1)]):t._e()])},E=[],O=(n("c1b0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{position:"relative",margin:"0",padding:"0"},style:{width:t.width+"px",height:t.height+"px"}},[n("canvas",{ref:"canvas",staticStyle:{position:"relative",margin:"0",padding:"0"},style:{width:t.width+"px",height:t.height+"px"},attrs:{width:t.width,height:t.height}})])}),T=[],j={name:"MyCanvasRect",props:["width","height"],data:function(){return{drawing:!1,p1:null,p2:null,ctx:null,canvas:null}},mounted:function(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.setListeners()},methods:{clearCanvas:function(){this.ctx.clearRect(0,0,this.width,this.height)},draw:function(){if(null!==this.p1&&null!==this.p2&&!1!==this.drawing){this.clearCanvas(),this.ctx.strokeStyle="red",this.ctx.strokeWidth=1,this.ctx.lineWidth=1;var t=this.p1[0],e=this.p1[1],n=this.p2[0],a=this.p2[1];this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(t,a),this.ctx.lineTo(n,a),this.ctx.lineTo(n,e),this.ctx.lineTo(t,e),this.ctx.stroke()}},mouseDownListener:function(t){this.canvas.setPointerCapture(t.pointerId),this.drawing=!0,this.p1=[t.layerX,t.layerY]},mouseMoveListener:function(t){this.drawing&&(this.p2=[t.layerX,t.layerY],this.p2[0]<0&&(this.p2[0]=0),this.p2[0]>this.width&&(this.p2[0]=this.width-1),this.p2[1]<0&&(this.p2[1]=0),this.p2[1]>this.height&&(this.p2[1]=this.height-1),this.draw())},mouseUpListener:function(t){this.canvas.releasePointerCapture(t.pointerId),this.$emit("rect",{p1:this.p1,p2:this.p2}),this.reset()},reset:function(){this.p1=null,this.p2=null,this.drawing=!1,this.clearCanvas()},setListeners:function(){this.canvas.addEventListener("pointerdown",this.mouseDownListener),this.canvas.addEventListener("pointermove",this.mouseMoveListener),this.canvas.addEventListener("pointerup",this.mouseUpListener)}}},L=j,R=(n("b28a"),Object(P["a"])(L,O,T,!1,null,"46d1d9ce",null)),A=R.exports,M={name:"EditFile",components:{MyCanvasRect:A},data:function(){return{classList:[],pages:null,currentSelectedClass:"0000",currentPageIndex:0,currentActiveNote:null,lastActiveNote:null}},methods:{switchClass:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("0000"!==t.currentSelectedClass){e.next=4;break}return t.pages=null,t.currentPageIndex=0,e.abrupt("return");case 4:return t.pages=null,t.currentPageIndex=0,m(),e.prev=7,e.t0=JSON,e.next=11,l("http://localhost:5000/get_class_data?className="+t.currentSelectedClass);case 11:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),n.ok?t.pages=n.data.pages:alert(n.message),e.next=20;break;case 16:e.prev=16,e.t2=e["catch"](7),console.log(e.t2),alert("课程数据加载失败, 请检查网络连接");case 20:b();case 21:case"end":return e.stop()}}),e,null,[[7,16]])})))()},switchPage:function(t){this.currentPageIndex=t},savePageNotes:function(t){d("http://localhost:5000/update_class_data",JSON.stringify({className:this.currentSelectedClass,pageIndex:this.currentPageIndex,pageNotes:this.pages[this.currentPageIndex].pageNotes}))},clearNoteIndicator:function(){var t=document.getElementById("canvas_note_indicator"),e=t.getContext("2d");e.clearRect(0,0,1400,700)},drawNoteIndicator:function(t){var e=t.offsetTop-t.offsetParent.scrollTop,n=1100,a=document.getElementById("canvas_note_indicator"),s=a.getContext("2d");s.clearRect(0,0,1400,700),s.lineWidth=3,s.strokeStyle="red",s.strokeRect(t.dataset.x,t.dataset.y,t.dataset.width,t.dataset.height),s.beginPath(),s.moveTo(t.dataset.x,t.dataset.y),s.lineTo(1050,t.dataset.y),s.lineTo(n+1,e+20),s.stroke()},noteFocus:function(t){this.currentActiveNote=t.target,this.drawNoteIndicator(t.target)},noteBlur:function(t){var e=this;this.pages[this.currentPageIndex].pageNotes[this.currentActiveNote.dataset.index].noteContent=this.currentActiveNote.innerText,this.clearNoteIndicator(),this.savePageNotes(),this.lastActiveNote=e.currentActiveNote,this.currentActiveNote=null,setTimeout((function(){e.lastActiveNote=null}),300)},notesScroll:function(){this.currentActiveNote&&this.currentActiveNote.blur()},addNewNote:function(t){var e=this,n=t.p1[0],a=t.p1[1],s=t.p2[0],i=t.p2[1],r=v(n,a,s,i);r.noteContent="请输入笔记内容";var o=this.pages[this.currentPageIndex].pageNotes.length;this.pages[this.currentPageIndex].pageNotes.splice(o,0,r),this.$set(this.pages[this.currentPageIndex],"pageNotes",this.pages[this.currentPageIndex].pageNotes),setTimeout((function(){var t="ppt_note_item_"+o;document.getElementById(t).scrollIntoView(),setTimeout((function(){document.getElementById(t).focus(),e.addingNote=!1}),300)}),300)},deleteNote:function(t){t&&(this.pages[this.currentPageIndex].pageNotes.splice(t,1),this.$set(this.pages[this.currentPageIndex],"pageNotes",this.pages[this.currentPageIndex].pageNotes)),this.savePageNotes()}},mounted:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return m(),e.prev=1,e.t0=JSON,e.next=5,l("http://localhost:5000/get_class_list");case 5:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),n.ok?t.classList=n.data:alert(n.message),e.next=14;break;case 10:e.prev=10,e.t2=e["catch"](1),console.log(e.t2),alert("加载课程列表失败, 请检查网络连接状况");case 14:b();case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))()}},$=M,B=(n("f9dd"),Object(P["a"])($,S,E,!1,null,"39d4421e",null)),q=B.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"root container"},[t._m(0),n("hr"),n("br"),n("br"),n("div",[n("form",{staticClass:"form"},[n("div",{staticClass:"form-group"},[n("label",[t._v("教师姓名:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{required:"",placeholder:"请输入"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),n("br"),n("br"),n("div",{staticClass:"form-group"},[n("label",[t._v("教职工号:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.userId,expression:"userId"}],attrs:{required:"",placeholder:"请输入"},domProps:{value:t.userId},on:{input:function(e){e.target.composing||(t.userId=e.target.value)}}})])]),n("br"),n("br"),n("button",{on:{click:function(e){return t.login(t.username)}}},[t._v("登录")])])])},J=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[n("h3",[t._v("教师登录")])])}],U={name:"StudentLogin",data:function(){return{username:"",userId:""}},methods:{login:function(){this.$emit("login",this.username)}}},D=U,H=(n("a25f"),Object(P["a"])(D,F,J,!1,null,"902af7b4",null)),X=H.exports,W={name:"app",components:{UploadFile:k,EditFile:q,TeacherLogin:X},data:function(){return{nav:1,username:null,login:!1}},methods:{switchNav:function(t){(1!==this.nav||this.login)&&(this.nav=t)},loginSuccess:function(t){this.login=!0,this.username=t,this.switchNav(2)}},mounted:function(){}},z=W,Y=(n("6aef"),Object(P["a"])(z,s,i,!1,null,"4189100b",null)),G=Y.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(G)}}).$mount("#app")},"66c0":function(t,e,n){"use strict";var a=n("8ebb"),s=n.n(a);s.a},"6aef":function(t,e,n){"use strict";var a=n("4fcb"),s=n.n(a);s.a},8768:function(t,e,n){},"8ebb":function(t,e,n){},a25f:function(t,e,n){"use strict";var a=n("8768"),s=n.n(a);s.a},aff8:function(t,e,n){},b28a:function(t,e,n){"use strict";var a=n("aff8"),s=n.n(a);s.a},b4b3:function(t,e,n){},f9dd:function(t,e,n){"use strict";var a=n("b4b3"),s=n.n(a);s.a}});
//# sourceMappingURL=app.4b55549f.js.map